<html>
    <head>
        <%- include('head', {title: 'Settings'})%>   
    </head>
    <body>
        <%- include('navbar', {session: session, links: [{name: 'API', ref: '/api'}, {name: 'Settings', ref: '/settings'}, {name: 'Logout', ref: '/login/logout'}]});%>
        <%- include('greeter', {greeting})%>
        <div class="container">
            <div class="row">
                <div class="col s12 m6 l6">
                    <!-- User settings --------------------------------------------------------------------------------------------->
                    <h2>User Settings</h2>
                    <form action="/settings/users/create" method="POST">
                        <div class="row">
                            <h4>Create new user</h4>
                            <div class="input-field col s12">
                                <input id="newusername" type="text" class="validate" name="newusername" placeholder="Username" required>
                            </div>
                        </div>
                        <div class="row">
                            <div class="input-field col s12 m6 l6">
                                <input id="newpassword" type="password" class="validate" name="newpassword" placeholder="Password" required minlength="5">
                            </div>
                            <div class="input-field col s12 m6 l6">
                                <input id="confirmpassword" type="password" class="validate" name="confirm" placeholder="Confirm password" required minlength="5">
                            </div>
                        </div>
                        <div class="row">
                            <div class="col s12">
                                <input class="btn right" type="submit" value="Create">
                            </div>
                        </div>
                    </form>
                    <form action="/settings/users/modify" method="POST">
                        <div class="row">
                            <h4>Change your Password</h4>
                            <div class="input-field col s12 m6 l6">
                                <input id="newpassword" type="password" class="validate" name="newpassword" placeholder="Password" required minlength="5">
                            </div>
                            <div class="input-field col s12 m6 l6">
                                <input id="confirmpassword" type="password" class="validate" name="confirm" placeholder="Confirm password" required minlength="5">
                            </div>
                        </div>
                        <div class="row">
                            <div class="col s12">
                                <input class="btn right" type="submit" value="Update">
                            </div>
                        </div>
                    </form>
                    <form action="/settings/users/delete" method="POST">
                        <h4>Delete your Account</h4>
                        <div class="input-field col s12">
                            <input id="username" type="text" class="validate" name="username" placeholder="Type your username to confirm" required>
                        </div>
                        <div class="row">
                            <div class="col s12">
                                <input class="btn red right" value="Delete" type="submit">
                            </div>
                        </div>
                    </form>
                </div>
                <div class="col s12 m6 l6">
                    <!--  key settings ----------------------------------------------------------------------------------------------->
                    <h2>Key Settings</h2>
                    <form action="/settings/keys/create" method="POST">
                        <h4>Create API Key</h4>
                        <p>
                            <label>
                                <input type="checkbox" name="READ_SENSOR">
                                <span>Read Sensor</span>
                            </label>
                        </p>
                        <p>
                            <label>
                                <input type="checkbox" name="READ_INSTRUCTION">
                                <span>Read Instructions</span>
                            </label>
                        </p>
                        <p>
                            <label>
                                <input type="checkbox" name="WRITE_INSTRUCTION">
                                <span>Write Instructions</span>
                            </label>
                        </p>
                        <div class="col s12">
                            <input class="btn right" type="submit" value="Create">
                        </div>
                        
                    </form>
                    <form action="/settings/keys/delete" method="POST">
                        <h4>Delete API Key</h4>
                        <div class="input-field col s12">
                            <input id="key" type="text" class="validate" name="key" placeholder="Key" required>
                        </div>
                        <div class="row">
                            <div class="col s12">
                                <input class="btn red right" value="Delete" type="submit">
                            </div>
                        </div>
                    </form>
                </div>
            </div>
            <div class="row">
                <!-- CONFIGURATION ---------------------------------------------------------------->
                <h2>Configuration/Jobs</h2>
                <div class="col s12 m6 l6">
                    <form action="/settings/config/reload" method="POST">
                        <input type="submit" class="btn" name="reload" value="Reload config" >
                    </form>

                    <h4>Current Configuration:</h4>
                    <p class="code-text"><%=JSON.stringify(config)%></p>
                    <a class="btn" href="/settings/config/edit">Edit</a>
                </div>
                <div class="col s12 m6 l6">
                    <form action="/settings/config/newjob" method="POST" enctype="multipart/form-data">
                        <h4>Upload Job Script</h4>
                        <p>
                            Upload a new javascript file that can be run as a job.  Note that you still have to add the
                            job in the configuration file after uploading the script.
                        </p>
                        <input type="file" name="script">
                        <input type="submit" value="upload" class="btn">
                    </form>
                </div>

            </div>
        </div>

        <%- include('footer', {session: session}) %>
    </body>
</html>